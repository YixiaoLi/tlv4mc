\documentclass[a4j]{jsarticle}

\newcommand{\figref}[1]{図\ref{#1}}


\title{組込みRTOS向けアプリケーション開発支援ツール\\
TLV（トレース ログ ヴィジュアライザー）\\
フェーズ３ 要求仕様書}
\begin{document}
\maketitle
\titlepage

\section*{改訂履歴}
\begin{table}[h]
 \centering
 \begin{tabular}{|c|c|c|c|} \hline
  版番& 日付&    更新内容& 更新者\\ \hline\hline
  1.0 & 09/1/27& 新規作成& 柳澤\\ \hline
 \end{tabular}
\end{table}
\clearpage

\tableofcontents
\clearpage

\section{はじめに}
\subsection{本書の目的}
本書の目的は、文部科学省先導的ITスペシャリスト育成推進プログラム「OJLによる最先端技術適応能力を持つIT人材育成拠点の形成」プロジェクトにおける、OJL科目ソフトウェア工学実践研究の研究テーマである「組込みRTOS向けアプリケーション開発支援ツールの開発」に対して、その開発するソフトウェアに対する要求を記述することである。

本書は特に、フェーズ３における要求の記述を行う。

\subsection{本書の適用範囲}

本書は、組込みMPRTOS向けアプリケーション開発支援ツールの開発プロジェクト
（以下本プロジェクト）におけるフェーズ３に対する詳細な要求仕様を記述する．

\subsection{用語の定義/略語の説明}

\begin{table}[h]
 \centering
 \caption{用語定義}
 \begin{tabular}{|p{8em}|p{36em}|} \hline
  用語・略語& 定義・説明\\ \hline \hline
  TLV& Trace Log Visualizer\\ \hline
  MPRTOS& マルチプロセッサ対応リアルタイムオペレーティングシステム\\
  \hline
  トレースログファイル& 
      RTOSのトレースログ機能を用いて出力したトレースログや、
      シミュレータなどが出力するトレースログをファイルにしたもの\\
  \hline
  共通形式トレースログファイル&
      本ソフトウェアが扱うことの出来る形式をもつトレースログファイル。
      各種トレースログファイルは、この共通形式トレースログファイルに
      変換することにより本ソフトウェアで扱うことが出来るようになる。 \\
  \hline
  表示オブジェクト&
      可視化表示する対象\\
  \hline
  表示エリア&
      可視化表示する領域\\
  \hline
 \end{tabular}
\end{table}
\subsection{概要}
本書では、組込みMPRTOS向けアプリケーション開発支援ツールの
ソフトウェアの要求を記述する。
本書では、主にフェーズ３で追加する機能について記述する。

\clearpage
\section{概要説明}
\subsection{フェーズ３におけるソフトウェアの概要}
開発対象のソフトウェア（以下、本ソフトウェア）は、
組込みRTOS上のアプリケーションの実行時トレースログを解析し、
可視化表示する機能を提供する。

フェーズ２では、共通形式トレースログへの変換やルールファイルによる
可視化表示など、拡張性や柔軟性の支柱となる主要機能を実装した。
また、フェーズ１での評価を元に、UIの見直しや操作機能の追加を行った。

フェーズ３では、選択時点におけるCPU使用率の表示機能および、
CPUごとのタスク表示機能を実装する。

\subsection{フェーズ３で追加するソフトウェアの機能}
本節では、フェーズ３で追加するソフトウェアの機能を優先順位の高い順番に説明する。

\subsubsection{CPU使用率の表示}
ここでいうCPU使用率とは、load averageのことを指す。
load averageとは、平均してどれだけのタスクが待ち状態にあるかを示す値である。
この値がCPU個数を常に超えているならば、待ち状態のタスクが常に
存在することとなる。
そのため、性能を示す指標の一つとして用いられる。

任意の時点でのload averageを出力するためには、
任意の時点での実行待ちキューの要素数を知る必要がある。
このためには、初回にログを走査する時点で実行待ちキューの要素数に関するログを
生成する必要がある。
待ちタスクのログを生成しておけば、load averageの表示を求められたときに
ログから1分、5分、15分のload averageを算出して表示することができる。

\subsubsection{CPUごとのタスク表示}
フェーズ２におけるタスクの表示は、タスクを軸とし、
そのタスクが実行されたかどうかを可視化している。
フェーズ３では、これに加えてCPUを軸としてタスクの可視化ができるようにする。

\begin{figure}[b]
  \begin{verbatim}
 CPU1   タスクa   ■■■
        タスクb   　　　■■■
        タスクc   　　　　　　■■
 CPU2   タスクa   ■■
        タスクb   　　　■■■
        タスクc   　　　　　　　■
  \end{verbatim}
 \caption{タスクを展開した表示}
 \label{015037_27Jan09}
\end{figure}

\begin{figure}
 \begin{verbatim}
 CPU1   ■タスクa ■□タスクb □■タスクc ■
 CPU2   ■タスクa ■　　□タスクb 　　□

 \end{verbatim}
 \caption{タスクを展開しない表示}
 \label{015044_27Jan09}
\end{figure}

具体的には、\figref{015037_27Jan09}や\figref{015044_27Jan09}のような表示を
行う。

これを実現するためには、ディスパッチのログを追いかける際、どのCPUで
どのタスクが実行されたかに注目し、その情報を保存する必要がある。
フェーズ２のログ走査では、ディスパッチされたタスクには注目しているが
割り当てられたCPUには注目していない。
ここを確認するよう変更を加えれば可視化に必要な情報が入手できる。


\clearpage
\section*{参考文献}

\end{document}