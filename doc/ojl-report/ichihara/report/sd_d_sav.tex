\subsection{統計情報とグラフ設定の保存方法}
取得・生成した統計情報とグラフ設定の保存方法について3つの候補を挙げて検討した．
\figref{fig:statsfile}に示す．以下にそれぞれの利点・欠点を述べ，
検討した内容を示す．

\begin{figure}[ht]
\begin{center}
\includegraphics[scale=0.6]{statsfile.png}
\caption{統計情報とグラフ設定の保存方法の候補}
\label{fig:statsfile}
\end{center}
\end{figure}

候補1は，データポイントに依存しないグラフ設定と統計情報をそれぞれ別のファイルで保存する方法である．関連付用ファイルは，統計情報とグラフ設定のそれぞれを保存するファイルのパスまたは識別子を記述し，統計情報を保存するファイルからデータを取り出すときに使用する正規表現を記述する．データポイントに依存するグラフ設定は，統計情報を保存するファイルにデータポイントと関連付けて記述する．この方法についての利点と欠点を次に示す．
\paragraph{候補1の利点}
\begin{itemize}
\item  統計情報を保存するファイルのファイル形式を様々な方法で保存できるようにすることで，TLV以外のアプリケーションでも統計情報を利用できるようになる．

\item データポイントに依存しないグラフ設定を再利用できるようになり，グラフ設定を保存するファイルを1つ変更するだけで，その変更が関係する統計情報すべてに反映される．
\end{itemize}

\paragraph{候補1の欠点}
\begin{itemize}
\item ファイルを分散させることで，統計情報がどのようなグラフ設定で表示されるかが把握しづらい．

\item ファイル移動に弱い．関連付用ファイルを更新しなければならない．

\item 管理するファイルが候補2候補3より多いので保守性が低下する．

\item 統計情報を保存するファイルを他のアプリケーションで使用する場合，統計情報とは無関係の情報であるデータポイントに依存するグラフ設定が処理の障害となる．

\item TLVの使用環境により，グラフ設定を保存するファイルの内容が異なる場合があるので，統計情報を保存するファイルだけを異なる環境へ移すと，移動前の環境と同じグラフ設定でグラフ．

\item 統計情報の種類によっては，目盛幅などのグラフ設定をログごとに設定したいケースがあるので，その対応が難しい．

\item 正規表現は可読性が低く，難しい形式のファイルには対応しづらい．
\end{itemize}


候補2は，候補1同様にファイル分割を行うが，どちらもJSONで記述する方法である．候補1での関連付用ファイルの代わりに，統計情報を保存するファイルにグラフ設定を保存するファイルのパスまたは識別子を指定する．この方法についての利点と欠点を次に示す．
\paragraph{候補2の利点}
\begin{itemize}
\item データポイントに依存しないグラフ設定を再利用できるようになり，グラフ設定を保存するファイルを1つ変更するだけで，その変更が関係する統計情報すべてに反映される．
\item 候補1の欠点であった保守性の懸念とデータポイントに依存するグラフ設定の問題が緩和される．
\end{itemize}

\paragraph{候補2の欠点}
\begin{itemize}
\item ファイルを分散させることで，統計情報がどのようなグラフ設定で表示されるかが把握しづらい．

\item 統計情報を保存するファイルを他のアプリケーションで利用できない．

\item TLVの使用環境により，グラフ設定を保存するファイルの内容が異なる場合があるため，異なる環境でのグラフ設定が保障されない．

\item 統計情報の種類によっては，目盛幅などのグラフ設定をログごとに設定したいケースがあるので，その対応が難しい．
\end{itemize}

候補3は，統計情報もグラフ設定も1つのファイルに保存する方法である．この方法についての利点と欠点を次に示す．

\paragraph{候補3の利点}
\begin{itemize}
\item 統計情報がどのようにグラフ表示されるか把握しやすい．

\item 1つのファイルのみで完結するので，ファイルパスなどの整合性を気にしなくて良い．

\item 統計情報毎にグラフ設定ができる．

\item 実装が楽である．
\end{itemize}

\paragraph{候補3の欠点}
\begin{itemize}
\item 統計情報を保存するファイルを他のアプリケーションで利用できない．

\item 同じグラフ設定が複数のファイルに出現して冗長する．修正する場合に時間がかかる．
\end{itemize}

候補1は，他のアプリケーションの使用を最低限にする目的からすると，欠点に比べ利点が弱いので，残りの2つに絞られる．候補2と候補3では，実装の観点からすると，どちらもすべてJSONで記述するので，候補2から候補3への変更，または，その逆の変更が容易に行えると考えられる．よって，実装時間を考慮して，まずは容易に実装でき，欠点も少ない候補3を採用した．この統計情報とグラフ設定を含んだファイルのことを統計情報ファイルと呼ぶことにする．


